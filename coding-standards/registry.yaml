rules:
  - id: GO-STYLE-001
    title: "函数参数超过4个时必须使用结构体封装传参"
    language: go
    severity: warning
    domains: [STYLE]
    path: "coding-standards/rules/go/GO-STYLE-001.md"
    prompt_hint: >
      检查新增/修改的函数与方法签名：当参数数量大于4个时，必须将参数封装为结构体类型进行传递（可使用 Options/Params/Request 等命名）。
      允许保留 context.Context 作为首参，其余业务参数总数仍不得超过4个；如超过则必须封装。
      对于仅为避免改动而新增无意义参数的情况，应要求重构为结构体并保证字段命名清晰、可选字段使用指针或零值策略明确，并在注释中说明关键约束与默认行为。
  
  - id: GO-STYLE-002
    deprecated: false
    title: "结构体参数传递应优先使用指针，其余类型直接值传递"
    language: go
    severity: info
    domains: [STYLE]
    path: "coding-standards/rules/go/GO-STYLE-002.md"
    prompt_hint: >
      检查函数参数和返回值的类型使用方式：
      1）当参数为结构体（struct）时，优先使用指针传递（*T），以避免不必要的值拷贝，
        并确保对结构体字段的修改在调用方可见；
      2）当参数为基础类型（int、string、bool 等）或小型、不可变语义的数据时，
        应直接使用值传递，避免滥用指针增加复杂性；

  - id: GO-STYLE-003
    deprecated: false
    title: "禁止使用全局变量，避免隐式状态和副作用"
    language: go
    severity: warning
    domains: [STYLE]
    path: "coding-standards/rules/go/GO-STYLE-003.md"
    prompt_hint: >
      检查代码中是否定义或使用了包级全局变量（var 定义在 package 作用域）：
      1）除只读常量（const）和确有必要的不可变配置外，禁止使用可变全局变量；

  - id: GO-STYLE-004
    deprecated: false
    title: "闭包逻辑应保持简短，函数内定义的 func 不得超过 5 行"
    language: go
    severity: info
    domains: [STYLE]
    path: "coding-standards/rules/go/GO-STYLE-004.md"
    prompt_hint: >
      检查函数内部定义的匿名函数或闭包（func literal）：
      1）闭包体逻辑应保持高度内聚和简洁，原则上不超过 5 行有效代码
      2）若闭包包含复杂控制流、业务判断或多步处理，应将其抽取为具名函数
      若发现函数内定义的 func 逻辑超过 5 行，应提示拆分为独立函数。

  - id: GO-STYLE-005
    deprecated: false
    title: "禁止使用 map 的指针类型，直接使用 map 值传递"
    language: go
    severity: info
    domains: [STYLE]
    path: "coding-standards/rules/go/GO-STYLE-005.md"
    prompt_hint: >
      检查代码中是否出现 map 的指针类型（*map[K]V）作为参数、返回值或结构体字段：
      1）Go 中的 map 本身是引用语义，值传递时仅复制 header，底层数据仍然共享；
      2）使用 *map 不会带来性能收益，反而增加心智负担和空指针风险；
      3）如需在函数中修改 map 内容，直接传递 map 即可；
      4）若需要整体替换 map（重新分配），应通过返回值显式返回，而不是使用 map 指针。
      若发现 *map 的使用，应提示改为直接使用 map，并说明其引用语义特性。

  - id: GO-STYLE-006
    deprecated: false
    title: "业务逻辑中禁止使用 o1、value1 等无语义命名"
    language: go
    severity: info
    domains: [STYLE]
    path: "coding-standards/rules/go/GO-STYLE-006.md"
    prompt_hint: >
      检查业务逻辑代码（非通用工具函数、非算法/示例代码）中的变量、参数和返回值命名：
      1）禁止使用 o1、o2、v1、value1、tmp1 等无明确业务语义的命名；
      2）命名应体现业务含义、角色或来源（如 userID、instanceMeta、diskInfos、targetHost）；
      3）在对比、映射、聚合等业务处理中，应区分来源与语义（如 old/new、src/dst、expected/actual）；
      4）仅在极短作用域、且语义高度明确的场景下（如 for 循环索引 i、j）可例外。
      若在业务逻辑中发现无语义编号式命名，应提示重命名以提升可读性与可维护性。

  - id: GO-STYLE-007
    deprecated: false
    title: "函数默认需记录进入、离开与失败日志，工具类函数可简化日志"
    language: go
    severity: info
    domains: [STYLE, ERROR]
    path: "coding-standards/rules/go/GO-STYLE-007.md"
    prompt_hint: >
      检查函数中的日志记录策略是否符合规范：
      1）默认情况下，业务函数应在进入时记录入参关键信息，在正常返回时记录完成日志，
        在发生错误或异常路径时记录失败日志，便于问题定位与链路追踪；
      2）失败日志应包含足够的上下文（关键参数、错误原因、返回码等），避免仅打印 error；
      3）工具类或纯函数（如 UUID 生成、简单格式转换、无副作用计算）可例外，
        仅在需要时记录输出结果或完全不打日志；
      4）避免在高频调用的核心路径中打印冗余日志，应在可观测性与性能之间权衡。
      若业务函数缺失关键阶段日志，或工具类函数存在过度日志，应提示调整。

  - id: GO-STYLE-008
    deprecated: false
    title: "日志字段 Key 命名必须全小写并使用下划线分隔"
    language: go
    severity: info
    domains: [STYLE]
    path: "coding-standards/rules/go/GO-STYLE-008.md"
    prompt_hint: >
      检查使用 logit.String / logit.Error / logit.Reflect 等方式为日志添加 Field 的场景：
      1）Field 的 Key 必须使用全小写字母；
      2）多个单词之间使用下划线（_）连接，禁止驼峰、短横线或混合命名；
      3）Key 应具有稳定、明确的语义，避免随意缩写或临时命名；
      4）保持同一业务域内日志字段命名一致，便于日志聚合、检索与分析。
      若发现日志 Field Key 未使用小写下划线风格，应提示修正命名。

  - id: GO-STYLE-009
    deprecated: false
    title: "函数内重复打印同一日志字段时应复用上下文，避免重复添加 Field"
    language: go
    severity: info
    domains: [STYLE]
    path: "coding-standards/rules/go/GO-STYLE-009.md"
    prompt_hint: >
      检查在同一函数作用域内多条日志都需要输出相同 Field 的场景：
      1）若多个日志条目重复添加相同字段（反复调用 logit.Xxx("key", val)），应进行优化；
      2）推荐通过派生 logger / 预构建 fields / 统一上下文（如 With/Bind/Context logger 等）方式复用公共字段，
        保持日志一致性并减少重复代码；
      3）公共字段应覆盖整个函数生命周期内稳定不变的上下文（如 request_id、instance_id、host_name 等）；
      4）仅在字段值随步骤变化时，才在具体日志语句中单独补充或覆盖。
      若发现重复添加同一 Field 的日志写法，应提示使用上下文复用方式进行优化。

  - id: GO-STYLE-010
    deprecated: true
    title: "代码注释中禁止使用中文标点符号"
    language: go
    severity: info
    domains: [STYLE]
    path: "coding-standards/rules/go/GO-STYLE-010.md"
    prompt_hint: >
      检查代码中的注释内容（行注释、块注释、文档注释）：
      1）禁止在注释中使用中文标点符号（如：，。；：“”《》等）；
      2）统一使用英文半角标点（, . ; : \" ' ( ) 等），保持风格一致；
      3）中文说明文本可以保留，但标点必须使用英文形式；
      若发现注释中包含中文标点符号，应提示替换为英文标点。
